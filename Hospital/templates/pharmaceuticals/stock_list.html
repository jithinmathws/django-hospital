{% extends 'home/base-login.html' %}
{% load compress static %}
{% block title %} Stock list {% endblock %}

{% block content %}
  
      
      <div class="content container-fluid">
         
         <div class="page-header">

        <div class="row align-items-center">
           <div class="col">
              <h3 class="page-title">Stocks</h3>
              <ul class="breadcrumb">
                 <li class="breadcrumb-item"><a href="{% url 'Inventoryindex' %}">Dashboard</a></li>
                 <li class="breadcrumb-item active">List of Doctors</li>
              </ul>
           </div>

           <div class="top-nav-search">
            <form method="get" action="">
               <input type="text" id="search" class="form-control" placeholder="Search here" name="search" value="{{ search_query }}">
               <button class="btn" type="submit"><i class="fas fa-search"></i></button>
               </form>
            </div>

           <div class="col-auto text-right float-right ml-auto">

            <ul class="nav user-menu">
            
               <a href="#" class="btn btn-outline-primary dropdown-toggle nav-link mr-2" data-toggle="dropdown"><i class="fas fa-download"></i> Download</a>

            <div class="dropdown-menu">
               
               <a class="dropdown-item" href="{% url 'stockExportCsv' %}" download>CSV file</a>
               
            </div>          
            
              <a href="{% url 'stockExcel' %}" class="btn btn-primary"><i class="fas fa-plus"></i></a>
            </ul>
           </div>
           
        </div>
     </div>
     
     <div class="row">
        <div class="col-sm-12">

         <form id="page-size-form" method="get" action="">
            <label for="page_size">Items per page:</label>
            <select id="page_size" name="page_size" onchange="updatePageSize()">
               <option value="5" {% if page_size == 5 %}selected{% endif %}>5</option>
               <option value="10" {% if page_size == 10 %}selected{% endif %}>10</option>
               <option value="20" {% if page_size == 20 %}selected{% endif %}>20</option>
               <option value="40" {% if page_size == 40 %}selected{% endif %}>40</option>
            </select>
         </form>
         <section id="messages">
            {% include 'pharmaceuticals/partials/toast.html' %}
        </section>
           <div class="card card-table">
              <div class="card-body">
                 <div class="table">
                    <table class="table table-hover table-center mb-0 sortable">
                       <thead>
                          <tr>
                             <th>ID</th>
                             <th>Product name</th>
                             <th>Category</th>
                             <th>Price</th>
                             <th>Stock Remaining</th>
                             <th>Created</th>
                             <th>Last Updated</th>
                             
                             
                             <th class="text-right">Action</th>
                          </tr>
                       </thead>
                       {% for data in stock_page %}
                       <tbody>
                          <tr>
                             <td>{{ data.id }}</td>
                             <td>
                              <h2 class="#">
                              <a href="{% url 'stock_profile' data.id %}">{{ data.item_name }}</a>
                              </h2>
                             </td>
                             <td>
                                {{ data.category.name }}
                             </td>
                             <td>
                              {{ data.price }}
                           </td>
                             <td  align="center">
                                 {% if data.stock <= data.stock_reorder_level %}
                                    <div style="background-color: orange;"> {{ data.stock }} </div>
                                 {% else %} 
                                    {{ data.stock }}
                                 {% endif %}
                             </td>
                             <td>
                                {{ data.created }}
                             </td>
                             <td>
                              {{ data.last_updated }}
                           </td>
                             

                             
                             <td class="text-right">
                                <div class="actions">
                                   <a href="{% url 'stock_edit' data.id %}" class="btn btn-sm bg-success-light mr-2">
                                   <i class="fas fa-pen"></i>
                                   </a>
                                   <a href="#" class="btn btn-sm bg-danger-light" onclick="confirmDelete('{{ data.item_name }}', '{{ data.id }}')">
                                   <i class="fas fa-trash"></i>
                                   </a>
                                </div>
                             </td>
                          </tr>
                          
                       </tbody>
                        <section id="messages">
                           {% include 'pharmaceuticals/partials/toast.html' %}
                        </section>
            
                       {% endfor %}
                    </table>
                    
                 </div>
                 <nav>
                  <ul class="pagination">

                     {% for page_num in doctors_page.paginator.page_range %}
                        <li class="page-item{% if page_num == stock_page.number %} active{% endif %}"> -->
                           <a class="page-link" href="?page={{ page_num }}&page_size={{ page_size }}">{{ page_num }}</a>
                        </li> 
                     {% endfor %}
                  </ul>
                 </nav>
              </div>
            </div>
            
         </div>
       
   <script>
      function updatePageSize(){
         document.getElementById("page-size-form").submit();
      }
   </script>         
  <script>
   function confirmDelete(roleName, roleId){
      if(confirm(`Are you sure you want to delete ${name}?`)) {
         window.location.href = `{% url 'stock_delete' stock_id=0 %}`.replace('0', roleId);
      }
   }
  </script>

   <link href="https://cdn.jsdelivr.net/gh/tofsjonas/sortable@latest/sortable.min.css" rel="stylesheet" />
   <script src="https://cdn.jsdelivr.net/gh/tofsjonas/sortable@latest/sortable.min.js"></script>
{% compress js %}  
   <!-- <script type="text/javascript" src="{% static 'tableManager.js' %}"></script> -->
  <!-- <script src="{% static 'prescol/plugins/datatables/datatables.min.js' %}"></script> -->
{% endcompress %}




  {% endblock %}
 